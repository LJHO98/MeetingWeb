<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      layout:decorate="~{fragment/layout}">
<head>
    <meta charset="UTF-8">
    <title>모임 게시판</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.tiny.cloud/1/v66zwuo2z8kbdl4t3rglfdpi9lmstor02zcg46dlh7k7q83b/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>

    <th:block layout:fragment="css"></th:block>
    <th:block layout:fragment="script"></th:block>

    <link rel="stylesheet" href="/css/group/groupBoard.css">
    <link rel="stylesheet" href="/css/group/groupTop.css">

    <script src="/js/groupBoard.js"></script>
</head>

<div layout:fragment="body" id="groupBoardMain">

    <div th:if="${errorMessage}">
        <script th:inline="javascript">
            /*<![CDATA[*/
            showAlert([[${errorMessage}]]);
            /*]]>*/
        </script>
    </div>

    <th:block th:replace="group/groupTop :: groupTop"></th:block>

    <div id="groupBoardWrap">
        <div id="noticeWrap">
            <div id="noticeText">
                공지사항
                <i th:if="${isGroupOwner}" class="btn btn-primary btn-sm bi bi-plus-circle" onclick="addNoticeField()"></i>
            </div>

            <div id="noticeContainer"></div>

            <div id="noticeBox" th:each="notice : ${notices}">
                <div th:text="${notice.content}"></div>
                <button th:if="${isGroupOwner}" class="btn btn-danger btn-sm" th:onclick="'deleteNotice(' + ${notice.id} + ')'">삭제</button>
            </div>
        </div>

        <div id="postWrap">
            <div id="postText">
                활동 피드
                <button onclick="moveToWritePage()">작성</button>
            </div>

            <div id="postBox" th:each="post : ${posts}">
                <div id="writer">
                    <div id="img">
                        <img th:src="${post.profileImgUrl}" alt="Profile Image" />
                    </div>
                    <span th:text="${post.userName}">작성자</span>
                </div>
                <div id="post">
                    <a href="javascript:void(0)" th:text="${post.title}" th:onclick="openPostModal([[${post}]], [[${groupDetail.groupId}]])">
                        제목
                    </a>
                    <div th:utext="${post.content}">내용</div>
                </div>
            </div>
        </div>
    </div>

  <!-- 모달 HTML -->
  <div class="modal fade" id="postModal" tabindex="-1" aria-labelledby="postModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalTitle">제목</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p><strong>작성자:</strong> <span id="modalUserName"></span></p>
          <div id="modalContent">내용</div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
          <button type="button" class="btn btn-primary" id="editButton">수정</button>
          <button type="button" class="btn btn-danger" onclick="deletePost()">삭제</button>
        </div>
      </div>
    </div>
  </div>
</div>
</html>
